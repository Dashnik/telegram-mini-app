<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>24h Timer Mini App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
    }

    button {
      padding: 15px 30px;
      font-size: 18px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background-color: #0088cc;
      color: white;
      transition: 0.2s ease;
    }

    button:hover {
      background-color: #0077b3;
    }

    #result {
      margin-top: 20px;
      font-size: 20px;
      font-weight: bold;
    }
  </style>
</head>

<body>

  <button id="myButton">Click me</button>
  <div id="result"></div>

  <script>
    const tg = window.Telegram?.WebApp;
    if (tg) tg.expand();

    const button = document.getElementById("myButton");
    const result = document.getElementById("result");

    const STORAGE_KEY = "timerEndTime";
    let timerInterval = null;

    function startTimer(endTime) {
      clearInterval(timerInterval);

      function update() {
        const now = Date.now();
        const diff = endTime - now;

        if (diff <= 0) {
          clearInterval(timerInterval);
          localStorage.removeItem(STORAGE_KEY);
          result.innerText = "Timer finished";
          return;
        }

        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

        result.innerText = `Time left: ${hours}h ${minutes}m`;
      }

      update();
      timerInterval = setInterval(update, 1000);
    }

    // Restore timer if it exists
    const savedEndTime = localStorage.getItem(STORAGE_KEY);
    if (savedEndTime) {
      startTimer(parseInt(savedEndTime));
    }

    // Button click â†’ reset to 24 hours
    button.addEventListener("click", () => {
      const newEndTime = Date.now() + 24 * 60 * 60 * 1000;
      localStorage.setItem(STORAGE_KEY, newEndTime);
      startTimer(newEndTime);
    });

  </script>

</body>
</html>
